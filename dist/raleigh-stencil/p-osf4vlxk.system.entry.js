var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var r=Array(e),n=0,t=0;t<i;t++)for(var s=arguments[t],a=0,l=s.length;a<l;a++,n++)r[n]=s[a];return r};System.register(["./p-48a2f890.system.js","./p-56a0fcc9.system.js"],(function(e){"use strict";var t,i,r;return{setters:[function(e){t=e.r;i=e.h},function(e){r=e.e}],execute:function(){var n=e("find_my_service",function(){function e(e){t(this,e);this.council=false;this.webmaps=[];this.maps=[];this.councilInfo=[];this.features=[]}e.prototype.initializeMap=function(){var e=this;r(["esri/portal/Portal","esri/widgets/Search","esri/WebMap","esri/layers/FeatureLayer","esri/tasks/Locator"]).then((function(t){var i=t[0],r=t[1],n=t[2],s=t[3],a=t[4];e.search=new r({container:"searchDiv",includeDefaultSources:false,sources:[{locator:new a({url:"https://maps.raleighnc.gov/arcgis/rest/services/Locators/FindMyService/GeocodeServer"}),placeholder:"Search by address"}]});e.search.on("select-result",(function(t){e.maps=[];var i=[];e.councilInfo=[];new s({url:"https://maps.raleighnc.gov/arcgis/rest/services/Planning/Jurisdictions/MapServer/0"}).queryFeatureCount({geometry:t.result.feature.geometry,outFields:["*"],where:"LONG_NAME = 'RALEIGH'"}).then((function(r){e.webmaps.forEach((function(n){if(n.portalItem.title.includes("Leaf")&&r===0){console.log("Leaf collection not available outside city limits")}else{var s=0;var a=[];if(e.layers){a=e.layers.split(",")}var l=[];n.layers.forEach((function(r){if(a.length===0||a.includes(r.title)){r.queryFeatures({geometry:t.result.feature.geometry,outFields:["*"]}).then((function(t){l=__spreadArrays(l,[{title:r.title,features:t.features,id:r.id}]);s+=t.features.length;if(e.council&&r.title.includes("City Council")&&t.features.length>0){console.log(t.features[0]);t.features[0].useDefaultPopupTemplate=false;t.features[0].layer.popupTemplate.content[0].text='<div style="padding:30px"><img alt="" src="{expression/expr0}" style="padding-right:1em;max-height:200px;"/>';t.features[0].layer.popupTemplate.content[0].text+="<h5>{COUNCIL_PERSON}</h5><span>Raleigh City Council</span><div>District {COUNCIL_DIST}</div><div><a href='https://www.raleighnc.gov/services/government/city-council-and-committees'><span>Website </span></a></div></div>";t.features[0].layer.popupTemplate.title="";e.councilInfo.push(t.features[0])}if(l.length===n.layers.length||a.length===l.length){l.sort((function(e,t){if(e.title<t.title){return-1}if(e.title>t.title){return 0}}));i=__spreadArrays(i,[{title:n.portalItem.title,featureCnt:s,layers:l}])}if(i.length===e.webmaps.length){i.sort((function(e,t){if(e.title<t.title){return-1}if(e.title>t.title){return 0}}));e.maps=__spreadArrays(i)}}))}}))}}))}))}));var l=new i;l.load().then((function(){var t={query:"id: a8acaca3d4514d40bc7f302a8db291fb",sortField:"title"};l.queryGroups(t).then((function(i){if(i.results.length){t={query:"type: map",sortField:"title"};var r=[];if(e.categories){r=e.categories.split(",")}i.results[0].queryItems(t).then((function(t){if(t.results.length){t.results.forEach((function(i){console.log(r);if(r.length===0||r.includes(i.title)){new n({portalItem:{id:i.id}}).loadAll().then((function(i){i.layers.items.forEach((function(e){e.features=[]}));i.featureCnt=0;e.webmaps.push(i);if(e.webmaps.length===t.results.length){e.webmaps=__spreadArrays(e.webmaps)}}))}}))}}))}}))}))}))};e.prototype.componentDidLoad=function(){this.webmaps=[];this.initializeMap()};e.prototype.componentWillLoad=function(){if(this.search){this.search.destroy()}if(document.getElementById("searchDiv")){document.getElementById("searchDiv").innerHTML=""}this.maps=[]};e.prototype.loadFeatureWidget=function(e,t){r(["esri/widgets/Feature"]).then((function(i){var r=i[0];setTimeout((function(){var i=new r({container:e});i.graphic=t}),200)}))};e.prototype.disconnectedCallback=function(){document.getElementById("councilDiv").innerHTML=""};e.prototype.render=function(){var e=this;return this.council?i("div",null,i("div",{id:"searchDiv"}),i("div",{class:"o-layout-sidebar-after o-layout-sidebar-after--tight"},this.councilInfo.map((function(t){return i("div",{id:"councilDiv",class:"o-layout-sidebar-after__secondary"},e.loadFeatureWidget("councilDiv",t))})),i("ol",{class:"o-layout-grid o-layout-grid--3 o-layout-sidebar-after__primary"},this.maps.map((function(t){return t.featureCnt>0?i("li",{class:"o-layout-grid__item"},i("div",null,i("h3",null,t.title),t.layers.map((function(t){return t.features.length>0?i("div",null,t.features.map((function(r,n){return e.council&&t.title.includes("City Council")?i("div",null):i("div",{id:t.id+"_"+n},e.loadFeatureWidget(t.id+"_"+n,r),i("br",null))}))):i("div",null)})))):i("div",null,"Services not provided for this address")}))))):i("div",null,i("div",{id:"searchDiv"}),i("div",null,i("ol",{class:"o-layout-grid o-layout-grid--3"},this.maps.map((function(t){return i("li",{class:"o-layout-grid__item"},i("div",null,i("h3",null,t.title),t.layers.map((function(t){return t.features.length>0?i("div",null,t.features.map((function(r,n){return i("div",{id:t.id+"_"+n},e.loadFeatureWidget(t.id+"_"+n,r),i("br",null))}))):i("div",{class:"esri-feature esri-widget"},i("br",null),i("h4",{class:"esri-feature__title"},t.title),i("div",{class:"esri-feature__text esri-feature__content-element"},i("div",{class:"esri-feature__main-container"},"Service not provided for this address")))}))))})))))};Object.defineProperty(e,"style",{get:function(){return"\@import url(\"https://js.arcgis.com/4.13/esri/themes/light/main.css\");"},enumerable:true,configurable:true});return e}())}}}));