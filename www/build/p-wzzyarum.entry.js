import{r as t,h as i,g as e}from"./p-ea61ee30.js";import{e as s,a as n}from"./p-1173ef90.js";const o=class{constructor(i){t(this,i),this.search=!1,this.layerlist=!1,this.legend=!1,this.navigate=!0,this.popup=!0,this.filter=!1,this.popupdocked=!1,this.dockposition="auto",this.highlight=!0,this.scene=!1,this.basemapselect=!1,this.collapsewidgets=!0,this.darkMode=!1,this.list=!1,this.divId="",this.features=[],this.getRandomString=function(){var t=2147483648;return Math.floor(Math.random()*t).toString(36)+Math.abs(Math.floor(Math.random()*t)^+new Date).toString(36)},this.searchLoaded=(t,i)=>{this.address&&t.search(this.address),t.goToOverride=(t,e)=>(this.zoom&&(e.target.zoom=this.zoom),t.graphics.removeAll(),t.graphics.add({symbol:{type:"simple-marker",path:"M15.65,36.85c1.9,2.3,4.47,4.93,7.8,7.45c0.49,0.37,0.99,0.73,1.51,1.09c0.54-0.37,1.07-0.75,1.58-1.14c10.44-7.92,15.7-18.63,15.7-24.62c0-8.93-6.84-16.3-15.56-17.13c-0.54-0.05-1.09-0.08-1.64-0.08l0,0l0,0l0,0l0,0c-0.72,0-1.42,0.06-2.11,0.14c-8.5,1.05-15.1,8.3-15.1,17.07C7.81,24.34,10.89,31.09,15.65,36.85z M22.91,4.38c0.69-0.1,1.39-0.16,2.11-0.16c0.56,0,1.1,0.03,1.65,0.09c7.73,0.83,13.77,7.38,13.77,15.33c0,5.71-5.17,15.99-15.42,23.54C14.77,35.63,9.6,25.35,9.6,19.64C9.6,11.85,15.4,5.41,22.91,4.38zM25.11,9.97c-5.67,0-10.29,4.62-10.29,10.29s4.62,10.29,10.29,10.29S35.4,25.93,35.4,20.26S30.79,9.97,25.11,9.97z M25.11,28.61c-4.6,0-8.35-3.74-8.35-8.35s3.74-8.35,8.35-8.35s8.35,3.74,8.35,8.35S29.72,28.61,25.11,28.61",size:24,color:i.map.basemap.title.toLowerCase().includes("dark")?"#FFFFFF":"#000000",outline:{color:i.map.basemap.title.toLowerCase().includes("dark")?"#FFFFFF":"#000000",width:"0.5px"},yoffset:4},geometry:e.target.target}),t.goTo(e.target,e.options))},this.setPopupConfig=()=>({highlightEnabled:this.highlight,dockEnabled:this.popupdocked,dockOptions:{position:this.dockposition,buttonEnabled:!1,breakpoint:!1}}),this.disableNavigation=t=>{t.ui.remove("zoom"),t.on("drag",(function(t){t.stopPropagation()})),t.on("key-down",(function(t){"Arrow"===t.key.slice(0,5)&&t.stopPropagation(),-1!==["+","-","Shift","_","="].indexOf(t.key)&&t.stopPropagation()})),t.on("mouse-wheel",(function(t){t.stopPropagation()})),t.on("double-click",(function(t){t.stopPropagation()})),t.on("double-click",["Control"],(function(t){t.stopPropagation()})),t.on("drag",["Shift"],(function(t){t.stopPropagation()})),t.on("drag",["Shift","Control"],(function(t){t.stopPropagation()}))},this.featureClicked=t=>{this.mapView.goTo(t)}}async initializeMap(){try{const[t,i,e]=await s(["esri/WebMap","esri/Map","esri/views/MapView"]);let n;return new e({map:n=this.mapId?new t({portalItem:{id:this.mapId}}):new i({basemap:this.basemap}),container:this.divId,popup:this.setPopupConfig()})}catch(t){console.log("EsriLoader: ",t)}}async initializeScene(){try{const[t,i,e]=await s(["esri/WebMap","esri/WebScene","esri/views/SceneView"]);let n;return this.mapId&&(n=new t({portalItem:{id:this.mapId}})),this.sceneId&&(n=new i({portalItem:{id:this.sceneId}})),new e({map:n,container:this.element,popup:this.setPopupConfig()})}catch(t){console.log("EsriLoader: ",t)}}async initializeSearch(t){try{const[i]=await s(["esri/widgets/Search"]);let e=new i({view:t,container:document.createElement("div"),popupEnabled:this.popup,resultGraphicEnabled:!1});return this.search&&t.ui.add({component:e,position:"top-left"}),e}catch(i){console.log("EsriLoader: ",i)}}async initializeLayerList(t){try{const[i,e]=await s(["esri/widgets/LayerList","esri/widgets/Expand"]);let n=new i({view:t,container:document.createElement("div")});t.ui.add(this.collapsewidgets?{component:new e({view:t,group:"top-right",expandTooltip:"Layers",expandIconClass:"esri-icon-layers",content:n.domNode,expanded:"layerlist"===this.expandedwidget&&-1===["xsmall"].indexOf(t.widthBreakpoint)}),position:"top-right"}:{component:n,position:"top-right"})}catch(i){console.log("EsriLoader: ",i)}}async initializeBaseMapGallery(t){try{const[i,e]=await s(["esri/widgets/BasemapGallery","esri/widgets/Expand"]);let n=new i({view:t,container:document.createElement("div")});t.ui.add(this.collapsewidgets?{component:new e({view:t,group:"top-right",expandTooltip:"Basemap Gallery",expandIconClass:"esri-icon-basemap",content:n.domNode,expanded:"basemap"===this.expandedwidget&&-1===["xsmall"].indexOf(t.widthBreakpoint)}),position:"top-right"}:{component:n,position:"top-right"})}catch(i){console.log("EsriLoader: ",i)}}async initializeLegend(t){try{const[i,e]=await s(["esri/widgets/Legend","esri/widgets/Expand"]);let n=new i({view:t,container:document.createElement("div")});t.ui.add(this.collapsewidgets?{component:new e({view:t,group:"top-right",expandTooltip:"Legend",expandIconClass:"esri-icon-layer-list",content:n.domNode,expanded:"legend"===this.expandedwidget&&-1===["xsmall"].indexOf(t.widthBreakpoint)}),position:"top-right"}:{component:n,position:"top-right"})}catch(i){console.log("EsriLoader: ",i)}}query(t){t.on("layerview-create",i=>{i.layer.title===this.querylayer&&(this.filter&&(i.layer.definitionExpression=this.querywhere,i.layer.refresh()),i.layer.queryFeatures({where:this.querywhere,returnGeometry:!0,outSpatialReference:t.spatialReference,outFields:["*"]}).then(i=>{if(i.features.length){let e={target:i.features};this.zoom&&(e.zoom=this.zoom),t.goTo(e,{duration:2500}),this.popup&&t.popup.open({features:i.features}),this.features=[...i.features]}}))})}componentDidLoad(){this.divId=this.getRandomString(),this.darkMode&&n("https://js.arcgis.com/4.13/esri/themes/dark/main.css"),this.initializeMap().then(t=>{this.mapView=t,t.ui.remove("zoom"),this.zoom&&!this.querylayer&&(t.zoom=this.zoom),this.querylayer&&this.querywhere&&this.query(t),this.navigate||this.disableNavigation(t),(this.search||this.address)&&this.initializeSearch(t).then(i=>this.searchLoaded(i,t)),this.layerlist&&this.initializeLayerList(t),this.basemapselect&&this.initializeBaseMapGallery(t),this.legend&&this.initializeLegend(t)})}loadFeatureWidget(t,i){s(["esri/widgets/Feature"]).then(([e])=>{setTimeout(()=>{new e({container:t}).graphic=i},200)})}render(){return this.list?i("div",{class:"container"},i("div",{class:this.list?"list-mode map":"",id:this.divId}),i("div",{class:this.list?"list-mode list":""},this.features.map(t=>i("div",{onClick:()=>{this.featureClicked(t)},id:this.divId+"_list_"+t.attributes.OBJECTID},this.loadFeatureWidget(this.divId+"_list_"+t.attributes.OBJECTID,t))))):i("div",{class:"container"},i("div",{id:this.divId}))}get element(){return e(this)}static get style(){return"\@import url(\"https://js.arcgis.com/4.13/esri/themes/light/main.css\");.esri-view{height:100%;width:100%}.list-mode{max-height:50%;overflow:auto}\@media only screen and (min-width:800px){.list-mode.list{max-width:400px}.list-mode.list,.list-mode.map{max-height:100%;overflow:auto;float:left}.list-mode.map{max-width:calc(100% - 400px)}}:host{position:absolute;left:0;right:0;bottom:0;top:0}.container,body,html{height:100%;width:100%;margin:0;font-family:sans-serif}"}};export{o as web_map};